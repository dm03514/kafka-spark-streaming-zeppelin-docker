{
  "paragraphs": [
    {
      "text": "%sh\npip install kafka-python\ncd /zeppelin \u0026\u0026 wget https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar \u0026\u0026 ls /zeppelin",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 18:16:46.655",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Requirement already satisfied (use --upgrade to upgrade): kafka-python in /opt/conda/lib/python2.7/site-packages\nYou are using pip version 8.1.2, however version 20.2.3 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n--2020-09-20 18:16:49--  https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\nResolving repo1.maven.org (repo1.maven.org)... 151.101.248.209\nConnecting to repo1.maven.org (repo1.maven.org)|151.101.248.209|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11292862 (11M) [application/java-archive]\nSaving to: ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.5’\n\n     0K .......... .......... .......... .......... ..........  0% 1.32M 8s\n    50K .......... .......... .......... .......... ..........  0% 3.19M 6s\n   100K .......... .......... .......... .......... ..........  1% 4.71M 5s\n   150K .......... .......... .......... .......... ..........  1% 7.67M 4s\n   200K .......... .......... .......... .......... ..........  2% 3.00M 4s\n   250K .......... .......... .......... .......... ..........  2% 8.53M 3s\n   300K .......... .......... .......... .......... ..........  3% 10.6M 3s\n   350K .......... .......... .......... .......... ..........  3% 10.7M 3s\n   400K .......... .......... .......... .......... ..........  4% 7.28M 3s\n   450K .......... .......... .......... .......... ..........  4% 8.28M 2s\n   500K .......... .......... .......... .......... ..........  4% 13.7M 2s\n   550K .......... .......... .......... .......... ..........  5% 14.9M 2s\n   600K .......... .......... .......... .......... ..........  5% 5.26M 2s\n   650K .......... .......... .......... .......... ..........  6% 16.7M 2s\n   700K .......... .......... .......... .......... ..........  6% 24.4M 2s\n   750K .......... .......... .......... .......... ..........  7% 27.7M 2s\n   800K .......... .......... .......... .......... ..........  7% 25.6M 2s\n   850K .......... .......... .......... .......... ..........  8% 24.9M 2s\n   900K .......... .......... .......... .......... ..........  8% 5.35M 2s\n   950K .......... .......... .......... .......... ..........  9% 15.2M 2s\n  1000K .......... .......... .......... .......... ..........  9% 20.9M 1s\n  1050K .......... .......... .......... .......... ..........  9% 21.7M 1s\n  1100K .......... .......... .......... .......... .......... 10% 17.8M 1s\n  1150K .......... .......... .......... .......... .......... 10% 11.0M 1s\n  1200K .......... .......... .......... .......... .......... 11% 45.8M 1s\n  1250K .......... .......... .......... .......... .......... 11% 13.3M 1s\n  1300K .......... .......... .......... .......... .......... 12% 53.3M 1s\n  1350K .......... .......... .......... .......... .......... 12% 28.9M 1s\n  1400K .......... .......... .......... .......... .......... 13% 5.89M 1s\n  1450K .......... .......... .......... .......... .......... 13% 18.3M 1s\n  1500K .......... .......... .......... .......... .......... 14% 45.3M 1s\n  1550K .......... .......... .......... .......... .......... 14% 67.7M 1s\n  1600K .......... .......... .......... .......... .......... 14% 27.1M 1s\n  1650K .......... .......... .......... .......... .......... 15% 17.8M 1s\n  1700K .......... .......... .......... .......... .......... 15% 19.4M 1s\n  1750K .......... .......... .......... .......... .......... 16% 12.0M 1s\n  1800K .......... .......... .......... .......... .......... 16% 16.9M 1s\n  1850K .......... .......... .......... .......... .......... 17% 44.2M 1s\n  1900K .......... .......... .......... .......... .......... 17% 24.4M 1s\n  1950K .......... .......... .......... .......... .......... 18% 19.3M 1s\n  2000K .......... .......... .......... .......... .......... 18% 22.5M 1s\n  2050K .......... .......... .......... .......... .......... 19% 17.4M 1s\n  2100K .......... .......... .......... .......... .......... 19% 15.0M 1s\n  2150K .......... .......... .......... .......... .......... 19% 26.9M 1s\n  2200K .......... .......... .......... .......... .......... 20% 16.2M 1s\n  2250K .......... .......... .......... .......... .......... 20% 57.8M 1s\n  2300K .......... .......... .......... .......... .......... 21% 15.6M 1s\n  2350K .......... .......... .......... .......... .......... 21% 35.5M 1s\n  2400K .......... .......... .......... .......... .......... 22% 22.4M 1s\n  2450K .......... .......... .......... .......... .......... 22% 24.2M 1s\n  2500K .......... .......... .......... .......... .......... 23% 26.0M 1s\n  2550K .......... .......... .......... .......... .......... 23% 23.1M 1s\n  2600K .......... .......... .......... .......... .......... 24% 18.5M 1s\n  2650K .......... .......... .......... .......... .......... 24% 20.3M 1s\n  2700K .......... .......... .......... .......... .......... 24% 33.8M 1s\n  2750K .......... .......... .......... .......... .......... 25% 29.7M 1s\n  2800K .......... .......... .......... .......... .......... 25% 44.9M 1s\n  2850K .......... .......... .......... .......... .......... 26% 14.7M 1s\n  2900K .......... .......... .......... .......... .......... 26% 15.7M 1s\n  2950K .......... .......... .......... .......... .......... 27% 43.3M 1s\n  3000K .......... .......... .......... .......... .......... 27% 25.0M 1s\n  3050K .......... .......... .......... .......... .......... 28% 5.28M 1s\n  3100K .......... .......... .......... .......... .......... 28% 43.7M 1s\n  3150K .......... .......... .......... .......... .......... 29% 31.0M 1s\n  3200K .......... .......... .......... .......... .......... 29% 43.2M 1s\n  3250K .......... .......... .......... .......... .......... 29% 39.4M 1s\n  3300K .......... .......... .......... .......... .......... 30% 35.2M 1s\n  3350K .......... .......... .......... .......... .......... 30% 21.0M 1s\n  3400K .......... .......... .......... .......... .......... 31% 40.9M 1s\n  3450K .......... .......... .......... .......... .......... 31% 33.9M 1s\n  3500K .......... .......... .......... .......... .......... 32% 25.6M 1s\n  3550K .......... .......... .......... .......... .......... 32% 21.3M 1s\n  3600K .......... .......... .......... .......... .......... 33% 10.3M 1s\n  3650K .......... .......... .......... .......... .......... 33% 15.6M 1s\n  3700K .......... .......... .......... .......... .......... 34% 55.7M 1s\n  3750K .......... .......... .......... .......... .......... 34% 32.6M 1s\n  3800K .......... .......... .......... .......... .......... 34% 49.6M 1s\n  3850K .......... .......... .......... .......... .......... 35% 16.7M 1s\n  3900K .......... .......... .......... .......... .......... 35% 39.4M 1s\n  3950K .......... .......... .......... .......... .......... 36% 35.0M 1s\n  4000K .......... .......... .......... .......... .......... 36% 9.36M 1s\n  4050K .......... .......... .......... .......... .......... 37% 2.98M 1s\n  4100K .......... .......... .......... .......... .......... 37% 15.2M 1s\n  4150K .......... .......... .......... .......... .......... 38% 21.6M 1s\n  4200K .......... .......... .......... .......... .......... 38% 38.6M 1s\n  4250K .......... .......... .......... .......... .......... 38% 14.0M 1s\n  4300K .......... .......... .......... .......... .......... 39% 22.5M 0s\n  4350K .......... .......... .......... .......... .......... 39% 26.2M 0s\n  4400K .......... .......... .......... .......... .......... 40% 18.8M 0s\n  4450K .......... .......... .......... .......... .......... 40% 24.6M 0s\n  4500K .......... .......... .......... .......... .......... 41% 36.1M 0s\n  4550K .......... .......... .......... .......... .......... 41% 17.1M 0s\n  4600K .......... .......... .......... .......... .......... 42% 28.5M 0s\n  4650K .......... .......... .......... .......... .......... 42% 17.5M 0s\n  4700K .......... .......... .......... .......... .......... 43% 18.7M 0s\n  4750K .......... .......... .......... .......... .......... 43% 23.2M 0s\n  4800K .......... .......... .......... .......... .......... 43% 27.3M 0s\n  4850K .......... .......... .......... .......... .......... 44% 35.8M 0s\n  4900K .......... .......... .......... .......... .......... 44% 18.2M 0s\n  4950K .......... .......... .......... .......... .......... 45% 23.0M 0s\n  5000K .......... .......... .......... .......... .......... 45% 28.7M 0s\n  5050K .......... .......... .......... .......... .......... 46% 43.3M 0s\n  5100K .......... .......... .......... .......... .......... 46% 20.5M 0s\n  5150K .......... .......... .......... .......... .......... 47% 18.4M 0s\n  5200K .......... .......... .......... .......... .......... 47% 24.3M 0s\n  5250K .......... .......... .......... .......... .......... 48% 14.4M 0s\n  5300K .......... .......... .......... .......... .......... 48% 39.2M 0s\n  5350K .......... .......... .......... .......... .......... 48% 27.0M 0s\n  5400K .......... .......... .......... .......... .......... 49% 28.2M 0s\n  5450K .......... .......... .......... .......... .......... 49% 18.1M 0s\n  5500K .......... .......... .......... .......... .......... 50% 16.3M 0s\n  5550K .......... .......... .......... .......... .......... 50% 56.4M 0s\n  5600K .......... .......... .......... .......... .......... 51% 21.6M 0s\n  5650K .......... .......... .......... .......... .......... 51% 23.8M 0s\n  5700K .......... .......... .......... .......... .......... 52% 15.2M 0s\n  5750K .......... .......... .......... .......... .......... 52% 14.2M 0s\n  5800K .......... .......... .......... .......... .......... 53% 29.2M 0s\n  5850K .......... .......... .......... .......... .......... 53% 19.5M 0s\n  5900K .......... .......... .......... .......... .......... 53% 32.7M 0s\n  5950K .......... .......... .......... .......... .......... 54% 27.8M 0s\n  6000K .......... .......... .......... .......... .......... 54% 23.0M 0s\n  6050K .......... .......... .......... .......... .......... 55% 52.0M 0s\n  6100K .......... .......... .......... .......... .......... 55% 73.5M 0s\n  6150K .......... .......... .......... .......... .......... 56% 6.23M 0s\n  6200K .......... .......... .......... .......... .......... 56% 14.3M 0s\n  6250K .......... .......... .......... .......... .......... 57% 37.1M 0s\n  6300K .......... .......... .......... .......... .......... 57% 31.7M 0s\n  6350K .......... .......... .......... .......... .......... 58% 43.5M 0s\n  6400K .......... .......... .......... .......... .......... 58% 20.6M 0s\n  6450K .......... .......... .......... .......... .......... 58% 34.4M 0s\n  6500K .......... .......... .......... .......... .......... 59% 26.2M 0s\n  6550K .......... .......... .......... .......... .......... 59% 38.2M 0s\n  6600K .......... .......... .......... .......... .......... 60% 34.0M 0s\n  6650K .......... .......... .......... .......... .......... 60% 16.8M 0s\n  6700K .......... .......... .......... .......... .......... 61% 19.9M 0s\n  6750K .......... .......... .......... .......... .......... 61% 17.1M 0s\n  6800K .......... .......... .......... .......... .......... 62% 62.8M 0s\n  6850K .......... .......... .......... .......... .......... 62% 47.0M 0s\n  6900K .......... .......... .......... .......... .......... 63% 28.4M 0s\n  6950K .......... .......... .......... .......... .......... 63% 17.3M 0s\n  7000K .......... .......... .......... .......... .......... 63% 42.8M 0s\n  7050K .......... .......... .......... .......... .......... 64% 26.9M 0s\n  7100K .......... .......... .......... .......... .......... 64% 18.2M 0s\n  7150K .......... .......... .......... .......... .......... 65% 23.7M 0s\n  7200K .......... .......... .......... .......... .......... 65% 35.5M 0s\n  7250K .......... .......... .......... .......... .......... 66% 20.1M 0s\n  7300K .......... .......... .......... .......... .......... 66% 36.3M 0s\n  7350K .......... .......... .......... .......... .......... 67% 31.6M 0s\n  7400K .......... .......... .......... .......... .......... 67% 83.7M 0s\n  7450K .......... .......... .......... .......... .......... 68% 16.9M 0s\n  7500K .......... .......... .......... .......... .......... 68% 16.7M 0s\n  7550K .......... .......... .......... .......... .......... 68% 15.6M 0s\n  7600K .......... .......... .......... .......... .......... 69% 18.5M 0s\n  7650K .......... .......... .......... .......... .......... 69% 27.0M 0s\n  7700K .......... .......... .......... .......... .......... 70% 15.8M 0s\n  7750K .......... .......... .......... .......... .......... 70% 34.4M 0s\n  7800K .......... .......... .......... .......... .......... 71% 44.7M 0s\n  7850K .......... .......... .......... .......... .......... 71% 56.3M 0s\n  7900K .......... .......... .......... .......... .......... 72% 65.5M 0s\n  7950K .......... .......... .......... .......... .......... 72% 57.4M 0s\n  8000K .......... .......... .......... .......... .......... 72% 63.4M 0s\n  8050K .......... .......... .......... .......... .......... 73% 72.9M 0s\n  8100K .......... .......... .......... .......... .......... 73% 21.4M 0s\n  8150K .......... .......... .......... .......... .......... 74% 20.1M 0s\n  8200K .......... .......... .......... .......... .......... 74% 71.9M 0s\n  8250K .......... .......... .......... .......... .......... 75% 52.5M 0s\n  8300K .......... .......... .......... .......... .......... 75% 26.8M 0s\n  8350K .......... .......... .......... .......... .......... 76% 10.0M 0s\n  8400K .......... .......... .......... .......... .......... 76%  101M 0s\n  8450K .......... .......... .......... .......... .......... 77% 19.7M 0s\n  8500K .......... .......... .......... .......... .......... 77% 23.1M 0s\n  8550K .......... .......... .......... .......... .......... 77% 14.8M 0s\n  8600K .......... .......... .......... .......... .......... 78% 59.5M 0s\n  8650K .......... .......... .......... .......... .......... 78% 32.1M 0s\n  8700K .......... .......... .......... .......... .......... 79% 51.2M 0s\n  8750K .......... .......... .......... .......... .......... 79% 25.5M 0s\n  8800K .......... .......... .......... .......... .......... 80% 19.2M 0s\n  8850K .......... .......... .......... .......... .......... 80% 43.0M 0s\n  8900K .......... .......... .......... .......... .......... 81% 43.7M 0s\n  8950K .......... .......... .......... .......... .......... 81% 30.8M 0s\n  9000K .......... .......... .......... .......... .......... 82% 32.4M 0s\n  9050K .......... .......... .......... .......... .......... 82% 15.0M 0s\n  9100K .......... .......... .......... .......... .......... 82% 35.0M 0s\n  9150K .......... .......... .......... .......... .......... 83% 29.8M 0s\n  9200K .......... .......... .......... .......... .......... 83% 18.3M 0s\n  9250K .......... .......... .......... .......... .......... 84% 21.9M 0s\n  9300K .......... .......... .......... .......... .......... 84% 24.5M 0s\n  9350K .......... .......... .......... .......... .......... 85% 18.4M 0s\n  9400K .......... .......... .......... .......... .......... 85% 26.9M 0s\n  9450K .......... .......... .......... .......... .......... 86% 21.3M 0s\n  9500K .......... .......... .......... .......... .......... 86% 98.0M 0s\n  9550K .......... .......... .......... .......... .......... 87%  122M 0s\n  9600K .......... .......... .......... .......... .......... 87% 25.8M 0s\n  9650K .......... .......... .......... .......... .......... 87% 38.4M 0s\n  9700K .......... .......... .......... .......... .......... 88% 24.2M 0s\n  9750K .......... .......... .......... .......... .......... 88% 50.3M 0s\n  9800K .......... .......... .......... .......... .......... 89% 16.6M 0s\n  9850K .......... .......... .......... .......... .......... 89% 13.4M 0s\n  9900K .......... .......... .......... .......... .......... 90% 20.6M 0s\n  9950K .......... .......... .......... .......... .......... 90% 43.4M 0s\n 10000K .......... .......... .......... .......... .......... 91% 13.7M 0s\n 10050K .......... .......... .......... .......... .......... 91% 25.1M 0s\n 10100K .......... .......... .......... .......... .......... 92% 29.3M 0s\n 10150K .......... .......... .......... .......... .......... 92% 24.4M 0s\n 10200K .......... .......... .......... .......... .......... 92% 17.7M 0s\n 10250K .......... .......... .......... .......... .......... 93% 22.4M 0s\n 10300K .......... .......... .......... .......... .......... 93% 31.4M 0s\n 10350K .......... .......... .......... .......... .......... 94% 49.7M 0s\n 10400K .......... .......... .......... .......... .......... 94%  111M 0s\n 10450K .......... .......... .......... .......... .......... 95%  117M 0s\n 10500K .......... .......... .......... .......... .......... 95% 97.7M 0s\n 10550K .......... .......... .......... .......... .......... 96%  106M 0s\n 10600K .......... .......... .......... .......... .......... 96% 82.2M 0s\n 10650K .......... .......... .......... .......... .......... 97% 82.7M 0s\n 10700K .......... .......... .......... .......... .......... 97% 93.2M 0s\n 10750K .......... .......... .......... .......... .......... 97% 99.6M 0s\n 10800K .......... .......... .......... .......... .......... 98%  102M 0s\n 10850K .......... .......... .......... .......... .......... 98%  111M 0s\n 10900K .......... .......... .......... .......... .......... 99% 6.43M 0s\n 10950K .......... .......... .......... .......... .......... 99% 23.0M 0s\n 11000K .......... .......... ........                        100% 57.9M\u003d0.6s\n\n2020-09-20 18:16:50 (18.6 MB/s) - ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.5’ saved [11292862/11292862]\n\nbin\nconf\ninterpreter\nlib\nLICENSE\nlicenses\nlocal-repo\nlogs\nnotebook\nNOTICE\nREADME.md\nrun\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.1\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.2\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.3\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.4\nspark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar.5\nwebapps\nzeppelin-web-0.8.1.war\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556538860554_-1121550077",
      "id": "20190429-115420_1698791579",
      "dateCreated": "2019-04-29 11:54:20.554",
      "dateStarted": "2020-09-20 18:16:46.768",
      "dateFinished": "2020-09-20 18:16:50.408",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.dep\n\nz.reset()\nz.load(\"/zeppelin/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\")",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 18:16:55.700",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res0: org.apache.zeppelin.dep.Dependency \u003d org.apache.zeppelin.dep.Dependency@e675f29\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1600565983053_358183074",
      "id": "20200920-013943_331382546",
      "dateCreated": "2020-09-20 01:39:43.053",
      "dateStarted": "2020-09-20 18:16:55.759",
      "dateFinished": "2020-09-20 18:17:05.277",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "",
      "text": "%producer.pyspark\n\nimport random\n\ntenants \u003d list(range(5))\nusers \u003d list(range(10000))\nlogin_events \u003d [\n    \u0027WIDGET_SHOW\u0027, \n    \u0027CAPTCHA_COMPLETE\u0027,\n    \u0027FAIL\u0027,\n    \u0027COMPLETE\u0027\n]\n\ndef record(ts):\n    user_id \u003d random.choice(users)\n    return {\n  \"id\": \"evt_32132112\",\n  \"type\": random.choice(login_events),\n  \"time\": ts,\n  \"ip\": \"182.29.170.142\",\n  \"data\": {\n    \"region\": \"eu\",\n    \"user\": {\n        \"email\": \"{user_id}_test@test_{user_id}.com\".format(user_id\u003duser_id)\n    },\n    \"tenant\": {\n      \"id\": random.choice(tenants)\n    }\n  }\n}\n",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 18:17:11.586",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "editorHide": false,
        "tableHide": false,
        "title": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556120282490_1275576273",
      "id": "20190424-153802_2004623441",
      "dateCreated": "2019-04-24 15:38:02.490",
      "dateStarted": "2020-09-20 18:17:11.634",
      "dateFinished": "2020-09-20 18:17:30.964",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%producer.pyspark\nimport time\nimport json\nimport random\nimport logging\n\nfrom kafka import KafkaProducer\nfrom kafka.errors import KafkaError\n\nKAFKA_BROKER \u003d \"host.docker.internal:9092\"\nKAFKA_TOPIC \u003d \"logins\"\n\nproducer \u003d KafkaProducer(bootstrap_servers\u003d[KAFKA_BROKER])\nindex \u003d 0\n\nwhile True:\n    \n    row_dict \u003d record(time.time())\n    \n    future \u003d producer.send(\n        topic\u003dKAFKA_TOPIC, \n        key\u003dstr(row_dict[\"id\"]).encode(\"utf-8\"),\n        value\u003djson.dumps(row_dict).encode(\"utf-8\"))\n    \n    try:\n        record_metadata \u003d future.get(timeout\u003d10)\n    except KafkaError:\n        # Decide what to do if produce request failed...\n        logging.exception(\"Error\")\n        pass\n    \n    producer.flush()\n    \n    index +\u003d 1\n    time.sleep(random.uniform(0.1,3.0))",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 17:04:54.112",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[0;31m\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0mTraceback (most recent call last)\n\u001b[0;32m\u003cipython-input-8-f435d34f6585\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     32\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     33\u001b[0m     \u001b[0mindex\u001b[0m \u001b[0;34m+\u003d\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 34\u001b[0;31m     \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msleep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrandom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muniform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0.1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m3.0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556124778874_694089528",
      "id": "20190424-165258_808657351",
      "dateCreated": "2019-04-24 16:52:58.874",
      "dateStarted": "2020-09-20 17:04:54.140",
      "dateFinished": "2020-09-20 17:08:39.146",
      "status": "ABORT",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nimport json\nfrom pyspark.streaming.kafka import KafkaUtils\nfrom pyspark.sql import types\nfrom pyspark.streaming import StreamingContext\nimport os\n# os.environ[\u0027PYSPARK_SUBMIT_ARGS\u0027] \u003d \u0027--jars /zeppelin/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar pyspark-shell\u0027 \n\ntry:\n    # Reset streaming context if exists\n    ssc.stop(stopSparkContext\u003dFalse, stopGraceFully\u003dFalse)\nexcept:\n    pass\n\nssc \u003d StreamingContext(sc, batchDuration\u003d2)\n\nLOGINS_TOPIC \u003d \"logins\"\nKAFKA_BROKERS \u003d \"host.docker.internal:9092,host.docker.internal:9092\"\n\n\nschema \u003d types.StructType([\n    types.StructField(\u0027id\u0027, types.StringType()),\n    types.StructField(\u0027type\u0027, types.StringType()),\n    types.StructField(\u0027time\u0027, types.IntegerType()),\n])\n\nstream \u003d KafkaUtils.createDirectStream(\n                            ssc, \n                            [LOGINS_TOPIC], \n                            {\"metadata.broker.list\": KAFKA_BROKERS})\ndef printer(x): \n    print(x)\n\nstream \u003d stream.map(lambda x: json.loads(x[1]))\nstream \u003d stream.window(60)\nstream \u003d stream.map(printer)\n# stream \u003d stream.map(lambda x: (x[\"id\"], x[\"data\"]))\n\nstream.pprint()\n\nssc.start()\nssc.awaitTermination()",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 17:06:51.801",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "-------------------------------------------\nTime: 2020-09-20 17:06:54\n-------------------------------------------\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:06:56\n-------------------------------------------\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:06:58\n-------------------------------------------\nNone\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:07:00\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:07:02\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:07:04\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:07:06\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n\n-------------------------------------------\nTime: 2020-09-20 17:07:08\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n-------------------------------------------\nTime: 2020-09-20 17:07:10\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n-------------------------------------------\nTime: 2020-09-20 17:07:12\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n-------------------------------------------\nTime: 2020-09-20 17:07:14\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n-------------------------------------------\nTime: 2020-09-20 17:07:16\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n-------------------------------------------\nTime: 2020-09-20 17:07:18\n-------------------------------------------\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\nNone\n...\n\n\u001b[0;31m\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0mTraceback (most recent call last)\n\u001b[0;32m\u003cipython-input-10-8e3877aa4a51\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     40\u001b[0m \u001b[0mssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstart\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 41\u001b[0;31m \u001b[0mssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTermination\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/streaming/context.py\u001b[0m in \u001b[0;36mawaitTermination\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    204\u001b[0m         \"\"\"\n\u001b[1;32m    205\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 206\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTermination\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    207\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    208\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTerminationOrTimeout\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0;36m1000\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args)\u001b[0m\n\u001b[1;32m   1129\u001b[0m             \u001b[0mproto\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mEND_COMMAND_PART\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1130\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-\u003e 1131\u001b[0;31m         \u001b[0manswer\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgateway_client\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msend_command\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcommand\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1132\u001b[0m         return_value \u003d get_return_value(\n\u001b[1;32m   1133\u001b[0m             answer, self.gateway_client, self.target_id, self.name)\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36msend_command\u001b[0;34m(self, command, retry, binary)\u001b[0m\n\u001b[1;32m    881\u001b[0m         \u001b[0mconnection\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_connection\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    882\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 883\u001b[0;31m             \u001b[0mresponse\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mconnection\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msend_command\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcommand\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    884\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mbinary\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    885\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mresponse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_create_connection_guard\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mconnection\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36msend_command\u001b[0;34m(self, command)\u001b[0m\n\u001b[1;32m   1026\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1027\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-\u003e 1028\u001b[0;31m             \u001b[0manswer\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0msmart_decode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstream\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreadline\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1029\u001b[0m             \u001b[0mlogger\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Answer received: {0}\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0manswer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1030\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0manswer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstartswith\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproto\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mRETURN_MESSAGE\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/opt/conda/lib/python2.7/socket.pyc\u001b[0m in \u001b[0;36mreadline\u001b[0;34m(self, size)\u001b[0m\n\u001b[1;32m    449\u001b[0m             \u001b[0;32mwhile\u001b[0m \u001b[0mTrue\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    450\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 451\u001b[0;31m                     \u001b[0mdata\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sock\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrecv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_rbufsize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    452\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0merror\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    453\u001b[0m                     \u001b[0;32mif\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m\u003d\u003d\u001b[0m \u001b[0mEINTR\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556022009133_-1199138898",
      "id": "20190423-122009_873241770",
      "dateCreated": "2019-04-23 12:20:09.133",
      "dateStarted": "2020-09-20 17:06:51.849",
      "dateFinished": "2020-09-20 17:07:20.150",
      "status": "ABORT",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2020-09-20 01:41:27.209",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1600566087208_-1909210092",
      "id": "20200920-014127_755542259",
      "dateCreated": "2020-09-20 01:41:27.208",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Example Kafka Spark Streaming",
  "id": "2EAB941ZD",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "producer:shared_process": [],
    "sh:shared_process": [],
    "consumer:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {}
}